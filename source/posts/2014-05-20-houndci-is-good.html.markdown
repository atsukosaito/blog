---
title: HoundCIでリポジトリに番犬を飼おう
date: 2014-05-20 06:39 JST
tags: rails, ci
thumb: /images/2014/houndci.png
---

プルリクエストのレビュー時に __「規約では１行あたり最大８０文字なので、１文字削ってください」__ などと一々指摘していると人間関係が破綻する可能性があります。  
こういう定量的なものに関してはロボットに任せるのが一番です。

そこで[HoundCI](https://houndci.com/sign_in)を使いましょう。  
これは[Rubocop](https://github.com/bbatsov/rubocop)にリポジトリを監視させるというコンセプトのサービスです。

READMORE

## HoundCIを使うメリット

1. コーディング規約違反のコードがmasterに入る前に必ず検知できる
2. チームメンバー全員でRubycopを使う必要がない
3. ダルいコーディング規約に関する議論が可視化できる
4. 人間関係が壊れない（重要）

---

### 気軽にみんなでRubocopを使える

- [Rubocopをsyntasticを使ってVimから自動実行する](http://qiita.com/yuku_t/items/0ac33cea18e10f14e185)
- [Rubocopを使ってコーディングルールへの準拠チェックを自動化](http://qiita.com/yaotti/items/4f69a145a22f9c8f8333)

Qiitaの上のような記事を読んでから、暇があったら導入しようと思ったけど、ついに導入しませんでした。というか、ルーチン化しなかった。Rubocopの存在は知っていても、チームメンバー全員に必ず使ってもらう、というのは結構ツラいのではないか。

Guardなどでルーチン化出来ればよいのですが、デザイナーさんもGitを使うご時世です。  
それに、使っていたとしても人間は失敗をする生き物なので、間違ってコミットする可能性もあります。

masterにコーディング規約に反したコードがコミットされるのを防ぐのが目的であれば、その箇所に一番近い部分でvalidationをかけるべきだと思います。

---

### この規約って必要？

デフォルトではHoundCIは[かなり厳しい規約](https://github.com/thoughtbot/guides/tree/master/style#ruby)を採用しており、「えっ？これって守る必要あるかな？」と疑問に思うことも少なくない。そんな時、ひとりでRubocop使っているとその状況を共有しづらいですが、Githubにコメントされるカタチで指摘されるのでメンバー全員でそれを確認することができます。

---

### 「いぬのくせにっ」

チーム円満の秘訣。

定量的に測定可能な細かいことはロボットに言わせましょう。細かいことを指摘するのも指摘されるのも人間相手だと気分の良いものではありません。でも、なぜかロボット相手だと「いぬのくせに生意気だ！」などと思う割に、嫌な気持ちにはなりません。

## HoundCIを使うデメリット

1. 秘密保護の問題
2. メール

---

### 秘密は守られるのか

信頼と実績の[thoughtbot](http://thoughtbot.com/)によって作られており、[ソース自体も公開されています](https://github.com/thoughtbot/hound)。

なので、自社などの安全な環境にホストして、 __好みのgithubユーザを作り上げ、それにビシバシと規約チェックをやってもらうというマゾヒスティックな運用__ もできそう。  
むしろそっちのほうが需要がありそうな気が...

---

### ワンワン！

むしろメリットですが、コーディング規約違反のコミットがpushされると指摘されます。
その箇所が多いとその数だけ指摘を受けるので、Githubからメールがたくさん届きます。とてもウザいですが、自分が悪いのでせっせと直しましょう。

<img src='/images/2014/houndci_screen_shot.png' class='img-responsive' alt='Houndに吠えられている様子です' />

いぬに吠えられている様子です( ˘ω˘)"

## まとめ

[HoundCI](https://houndci.com/sign_in)に行き、Githubアカウントでログインして、監視対象リポジトリを設定するだけです。

<img src='/images/2014/the_hound.jpeg' class='img-circle img-responsive' alt='the houndというようです' />

あと、いぬ、かわいい
